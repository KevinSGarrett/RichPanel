# Decision Log\n\nLast updated: 2026-01-03\nLast verified: 2026-01-03 - RUN_20260103_2300Z.\n\nUse this file to record decisions that impact design, scope, or risk.\n\n**Status legend**\n- âœ… Decided\n- ğŸŸ¡ Proposed (default in plan unless you override)\n- ğŸ”´ Rejected\n\n---\n- **2025-12-28** â€” Lock backend language (Lambda runtime) to **Python 3.11**.  \n  **Status:** âœ… Decided  \n  - Rationale: strong AWS Lambda ecosystem, great LLM/tooling support, aligns with existing repo scripts.  \n  - Owner: You + PM  \n\n- **2025-12-28** â€” Lock admin frontend framework to **Next.js (TypeScript)** (planning now; implementation later).  \n  **Status:** âœ… Decided  \n  - Rationale: mature ecosystem, TypeScript safety, flexible SSR/SPA model for an ops console.  \n  - Note: exact versions will be pinned when the UI is implemented (later wave).  \n  - Owner: You + PM  \n\n- **2025-12-23** â€” Select **AWS CDK (TypeScript)** as the IaC tool of record for v1.  \n  **Status:** âœ… Decided  \n  - Rationale: fast iteration for AWS serverless resources; keeps â€œECS laterâ€ path open.  \n  - Owner: You + PM  \n\n- **2025-12-23** â€” Use **AWS Secrets Manager** for all secrets (no secrets in repo).  \n  **Status:** âœ… Decided  \n  - Owner: You + PM  \n\n- **2025-12-23** â€” Agent operating model: **3 Cursor agents (A/B/C)** + ChatGPT PM; agents update docs directly every run; refactors allowed with guardrails.  \n  **Status:** âœ… Decided  \n  - Owner: You + PM  \n\n- **2025-12-23** â€” Include a **frontend/admin console skeleton** in the repo (planning now; implementation later).  \n  **Status:** âœ… Decided  \n  - Owner: You + PM  \n\n\n- **2025-12-22** â€” Runbooks must include **dashboards + metrics + log queries + smoke-test validation**.  \n  **Status:** âœ… Decided  \n  - Rationale: prevents â€œwe fixed it but re-enabled automation too earlyâ€; creates consistent operator playbooks.\n  - Implementation: each runbook R001â€“R010 includes a standard â€œSignals / Operator levers / Smoke testsâ€ section and links to Wave 06 (kill switch), Wave 07 (tuning), Wave 08 (observability), and Wave 09 (smoke pack).\n\n- **2025-12-21** â€” Initialized documentation plan structure and wave schedule.  \n  **Status:** âœ… Decided  \n  - Rationale: Required to keep a large plan navigable and prevent drift.\n  - Owner: PM\n\n- **2025-12-21** â€” Adopt a **two-layer routing model**: intent taxonomy â†’ destination queue/team.  \n  **Status:** âœ… Decided  \n  - Rationale: Prevents team mapping drift and keeps taxonomy stable even if org changes.\n  - Owner: PM + Support Ops\n\n- **2025-12-21** â€” Use a **risk-tiered automation policy** (Tier 0â€“3).  \n  **Status:** âœ… Decided  \n  - Rationale: Lets us automate safely without causing privacy or policy failures.\n  - Owner: PM + Support Ops\n\n- **2025-12-21** â€” Tier 2 order-status auto-replies may include **tracking link + tracking number** when there is a deterministic order match.  \n  **Status:** âœ… Decided  \n  - Source: you confirmed â€œyes, when deterministic match.â€\n  - Owner: You + PM\n\n- **2025-12-21** â€” Middleware should **auto-close only for whitelisted, deflection-safe templates (CR-001 adds order-status ETA exception)** tickets.  \n  **Status:** âœ… Decided  \n  - Source: you confirmed â€œA. never auto close.â€\n  - Rationale: Auto-close creates risk of missed edge cases and conflicts with existing Richpanel rules.\n  - Owner: You + PM\n\n- **2025-12-21** â€” Chargebacks/disputes must route to a **Chargebacks / Disputes** team/channel/queue (no automation).  \n  **Status:** âœ… Decided  \n  - Source: you explicitly stated chargebacks/disputes should go to a chargeback/dispute team/channel.\n  - Owner: You + PM\n\n- **2025-12-21** â€” Create a dedicated **Chargebacks / Disputes** queue (Richpanel Team + routing tag + assignment automation).  \n  **Status:** âœ… Decided  \n  - Source: you confirmed we can create this team if it is the best suggestion.\n  - Rationale: High-risk workflow benefits from limited membership, consistent macros, and clear reporting.\n  - Alternative: route to Leadership always (higher load; less specialized).\n  - Owner: You + Support Ops\n\n- **2025-12-21** â€” Missing/incorrect items + shipping exceptions are owned by **Returns Admin** (Fulfillment Exceptions / Claims).  \n  **Status:** âœ… Decided  \n  - Source: you approved using our best-suggestion default routing.\n  - Rationale: Requires reship/refund decisions and policy enforcement; best aligned with Returns/Refund authority.\n  - Alternative owners:\n    - Email Support Team (if Returns Admin is strictly returns-only)\n    - Dedicated Shipping/Claims team (future)\n  - Owner: You + Support Ops\n\n- **2025-12-21** â€” Delivered-but-not-received: send Tier 1 safe assist + route to human (no auto-resolve).  \n  **Status:** âœ… Decided  \n  - Source: you confirmed this is the best suggestion for the early rollout.\n  - Rationale: Customers need immediate guidance, but refunds/reships are too risky to automate.\n  - Owner: You + Support Ops\n\n- **2025-12-21** â€” Routing implementation: use **routing tags + Richpanel automations/views** to achieve â€œteam routingâ€; assign to agents via `assignee_id` only when needed.  \n  **Status:** âœ… Decided (plan default; verify in Wave 03)\n  - Rationale: Richpanel tickets typically do not expose a direct â€œteam fieldâ€ via API; tags and assignment rules are the stable control surface.\n  - Owner: PM + Engineering\n\n\n- **2025-12-21** â€” Order lookup approach: build an â€œOrder Lookupâ€ abstraction; prefer Richpanel order linkage when available; treat Shopify as source-of-truth.  \n  **Status:** ğŸŸ¡ Proposed (recommended default)  \n  - Rationale: Richpanel provides order linkage APIs, but Shopify remains the authoritative order system.\n  - Owner: Engineering + PM\n\n- **2025-12-21** â€” Use `SC_Data_ai_ready_package.zip` as evidence for planning (taxonomy, templates, evaluation design).  \n  **Status:** âœ… Decided  \n  - Source: you clarified you provided it to help create the development plan documentation.\n  - Requirements:\n    - do not paste raw transcripts into docs\n    - treat as sensitive data (PII)\n    - use only aggregated stats and sanitized examples\n  - Owner: PM\n- **2025-12-21** â€” Hosting decision: use **AWS Serverless** architecture (API Gateway + Lambda + SQS FIFO + DynamoDB).  \n  **Status:** âœ… Decided  \n  - Source: you have no AWS preference and asked for the best-suggested stack.\n  - Rationale: lowest ops burden + scales for webhook workloads + easy to enforce idempotency and backpressure.\n  - Notes: ECS/Fargate remains a future option if workloads grow or latency predictability becomes a hard requirement.\n  - Owner: You + PM\n\n- **2025-12-21** â€” Baseline latency targets for early rollout (by channel urgency class).  \n  **Status:** âœ… Decided  \n  - Source: you asked for the best recommendation for latency by channel.\n  - Defaults:\n    - Ingress ack p95 < 500ms\n    - Real-time channels: routing p95 < 15s; auto-reply p95 < 25s; p99 < 60s\n    - Email-like channels: routing p95 < 60s; auto-reply p95 < 120s; degraded p99 < 10min\n  - Owner: You + PM\n\n- **2025-12-21** â€” AWS primary region selection for v1: `us-east-2` (US East â€” Ohio).  \n  **Status:** âœ… Decided  \n  - Source: US-wide customer base; you asked us to choose the best region.\n  - Rationale: balanced US latency; standard AWS services; simple single-region rollout.\n  - Notes: DR region option documented as `us-west-2` (optional later).\n  - Owner: You + PM\n\n- **2025-12-21** â€” AWS environment strategy: separate accounts for `dev`, `staging`, `prod` under AWS Organizations (Control Tower optional).  \n  **Status:** âœ… Decided  \n  - Source: you asked for the best recommendation and approved it.\n  - Rationale: strong isolation boundary for security + blast radius reduction; clearer budgets/permissions.\n  - Minimal fallback: 2 accounts (`prod` + `nonprod`) if setup overhead is too high.\n  - Owner: You + PM\n\n- **2025-12-21** â€” AWS management account ownership: **You (developer)** own the AWS Organization management account (billing + org admin).  \n  **Status:** âœ… Decided  \n  - Source: you confirmed â€œI will own it.â€  \n  - Rationale: establishes a single accountable owner for account creation, billing, and break-glass access (reduces operational ambiguity).\n  - Notes: We still enforce root MFA + alternate contacts + break-glass documentation to prevent lockout.\n  - Owner: You\n\n- **2025-12-21** â€” AWS Control Tower adoption: **defer** (Organizations-only for v1).  \n  **Status:** âœ… Decided  \n  - Source: current state is no Control Tower; v1 requires speed + minimal setup overhead.\n  - Rationale: Organizations provides the required multi-account isolation; Control Tower can be added later when guardrails automation is worth the complexity.\n  - Owner: You + PM\n\n- **2025-12-21** â€” AWS foundation decision: use **AWS Organizations without Control Tower** for v1 (Control Tower optional later).  \n  **Status:** âœ… Decided  \n  - Source: you confirmed you do **not** have AWS Organizations / Control Tower set up yet and want the best recommended approach.\n  - Rationale: Organizations-only gets us the core benefit (account isolation + consolidated billing) with less overhead/moving parts than a Control Tower landing zone.\n  - Notes:\n    - Organizations is the required building block; Control Tower can be layered on later if you want automated guardrails + account vending.\n    - Detailed checklist lives in `docs/02_System_Architecture/AWS_Organizations_Setup_Plan_No_Control_Tower.md`.\n  - Owner: You + PM\n\n- **2025-12-21** â€” Channel urgency class: treat **LiveChat as the only â€œreal-timeâ€ channel** for v1; treat all other channels as asynchronous by default.  \n  **Status:** âœ… Decided (revisit if operations require)\n  - Source: you believe LiveChat only; you asked for recommended latency strategy.\n  - Rationale: aligns SLOs with actual operational needs; avoids unnecessary complexity.\n  - Owner: You + PM\n\n\n- **2025-12-21** â€” State + idempotency persistence: use **DynamoDB** with TTL-based cleanup (minimal v1 schema).  \n  **Status:** âœ… Decided  \n  - Rationale: required to prevent duplicate replies/routing and support safe multi-step flows.\n  - Reference: `docs/02_System_Architecture/DynamoDB_State_and_Idempotency_Schema.md`\n  - Owner: You + PM\n\n- **2025-12-21** â€” Rate limiting strategy (v1): enforce downstream protection via **worker reserved concurrency caps** + token buckets + 429 backoff + DLQ.  \n  **Status:** âœ… Decided  \n  - Rationale: prevents 429 storms and keeps system stable during spikes.\n  - Reference: `docs/07_Reliability_Scaling/Rate_Limiting_and_Backpressure.md`\n  - Owner: You + PM\n\n- **2025-12-21** â€” Initial worker reserved concurrency: start at **5** (tunable).  \n  **Status:** ğŸŸ¡ Proposed  \n  - Rationale: conservative default until we measure OpenAI/Richpanel/Shopify quotas and real processing time.\n  - Owner: You + PM\n\n- **2025-12-21** â€” Response generation policy (v1): prefer **template-based replies** (LLM used for classification/decisioning, not freeform replies).  \n  **Status:** ğŸŸ¡ Proposed  \n  - Rationale: reduces cost and risk; ensures consistent tone and prevents hallucinated claims.\n  - Reference: `docs/07_Reliability_Scaling/Cost_Model.md`\n  - Owner: You + PM\n\n- **2025-12-21** â€” v1 audit trail approach: **logs-only** (skip optional DynamoDB `rp_mw_audit_actions` table in v1).  \n  **Status:** âœ… Decided  \n  - Rationale: Keep v1 state footprint minimal and reduce PII risk; structured logs + CloudWatch Logs Insights are sufficient for early rollout troubleshooting.  \n  - Upgrade path: If durable audit becomes necessary (compliance/process), enable Table C in a later wave.  \n  - Owner: PM + Engineering\n\n- **2025-12-21** â€” v1 queue strategy: **single SQS FIFO queue** (no separate LiveChat â€œreal-time laneâ€ in v1).  \n  **Status:** âœ… Decided  \n  - Rationale: Current volumes are well within a single FIFO queueâ€™s capability; simpler operational surface for early rollout.  \n  - Trigger to revisit: LiveChat routing p95 consistently > 15â€“25s due to backlog.  \n  - Owner: PM + Engineering\n- **2025-12-22** â€” Richpanel API path convention for â€œconversationâ€ operations: use `/v1/tickets/{id}` (not `/v1/conversations/*`).  \n  **Status:** âœ… Decided  \n  - Source: Richpanel public API Reference labels the resource as â€œConversationâ€ but uses `https://api.richpanel.com/v1/tickets/{id}` for GET/PUT.  \n  - Rationale: prevents implementation drift and broken integrations caused by incorrect endpoint paths.  \n  - Owner: PM + Engineering\n\n- **2025-12-22** â€” Middleware inbound trigger placement (v1): prefer **Tagging Rules** (top of list), fallback to **first Assignment Rule**.  \n  **Status:** âœ… Decided  \n  - Rationale: your existing Assignment Rules frequently enable â€œSkip all subsequent rulesâ€, which can block later Assignment Rules. Tagging Rules are typically evaluated independently, making the trigger more reliable.  \n  - Owner: PM + Support Ops\n\n- **2025-12-22** â€” HTTP Target payload strategy (v1): start with **minimal payload** (`ticket_id` + `ticket_url`) and fetch message/context via API; add message text to payload only after JSON escaping is verified.  \n  **Status:** âœ… Decided  \n  - Rationale: avoids lost events caused by invalid JSON templates when message text contains quotes/newlines; provides a safe upgrade path that reduces API calls later.  \n  - Owner: PM + Engineering\n\n- **2025-12-22** â€” Defer Richpanel tenant/UI verification checks (HTTP Target placement, headers support, JSON templating escape behavior, and order-link reliability).  \n  **Status:** âœ… Decided  \n  - Source: owner requested we hold off and proceed with best-suggested defaults.\n  - Rationale: planning can continue safely because the integration design includes robust fallbacks (minimal payload + API reads; token in URL/body if headers unavailable; Assignment Rules trigger fallback; deterministic gating for order status).\n  - Reminder: run the verification checklist before implementation / go-live to confirm exact tenant capabilities and simplify the final config steps.\n  - Owner: You (AWS/Richpanel admin) + PM + Cursor builders\n\n\n\n- **2025-12-22** â€” Adopt **Structured Outputs** (JSON Schema) for all LLM decisions (`mw_decision_v1`), validated strictly in code (fail closed).  \n  **Status:** ğŸŸ¡ Proposed (default)  \n  - Rationale: prevents malformed JSON / missing fields; makes decisions auditable and testable.\n  - Artifacts: `docs/04_LLM_Design_Evaluation/schemas/`\n  - Owner: PM + Engineering\n\n- **2025-12-22** â€” Use a **single primary classifier call** (routing + tier + template plan) plus an optional **Tier 2 verifier** call for sensitive automation.  \n  **Status:** ğŸŸ¡ Proposed (default)  \n  - Rationale: reduces latency/cost vs multi-step prompting; verifier reduces Tier 2 false positives.\n  - Owner: PM + Engineering\n\n- **2025-12-22** â€” Default model strategy: `gpt-5-mini` (classification-style, reasoning effort none) with optional nanoâ†’mini cascade later.  \n  **Status:** ğŸŸ¡ Proposed (default)  \n  - Rationale: strong quality for classification with manageable cost/latency; cascade is a later optimization.\n  - Owner: PM + Engineering\n\n- **2025-12-22** â€” v1 taxonomy expanded to include: cancel_order, address_change_order_edit, cancel_subscription, billing_issue, influencer_marketing_inquiry.  \n  **Status:** ğŸŸ¡ Proposed (default)  \n  - Rationale: matches Top FAQs and prevents â€œunknownâ€ overuse.\n  - Source of truth: `docs/04_LLM_Design_Evaluation/Intent_Taxonomy_and_Labeling_Guide.md`\n  - Owner: PM + Support Ops\n\n- **2025-12-22** â€” Planning deliverable is **documentation-first**; Cursor usage during planning is **optional** (used only if explicitly requested or for feasibility validation).  \n  **Status:** âœ… Decided  \n  - Source: you clarified Cursor is intended for build phase; optional use is acceptable only if it increases efficiency.\n  - Rationale: Prevents process confusion; keeps plan as source of truth while allowing optional validation artifacts.\n  - Artifact location (optional): `reference_artifacts/`\n  - Owner: You + PM\n\n- **2025-12-22** â€” Multi-intent messages follow a **deterministic priority matrix** (Tier 0 overrides; P1 > P2 > P3 > P4 precedence).  \n  **Status:** âœ… Decided  \n  - Source: Wave 04 closeout (required for consistent routing + safety).  \n  - Rationale: Prevents â€œeasyâ€ intents (order status) from overriding high-risk workflows (chargebacks/legal/fraud).  \n  - Document: `docs/04_LLM_Design_Evaluation/Multi_Intent_Priority_Matrix.md`\n\n- **2025-12-22** â€” Customer-facing automation replies use **template_id only** (no free-form generated copy).  \n  **Status:** âœ… Decided  \n  - Source: Wave 04 closeout; aligns with â€œauto-close only for whitelisted, deflection-safe templates (CR-001 adds order-status ETA exception)â€ + safety requirements.  \n  - Rationale: Enables reviewable, auditable, and consistent messaging; reduces prompt-injection risk.  \n  - Document: `docs/04_LLM_Design_Evaluation/Template_ID_Catalog.md` (copy finalized in Wave 05).\n\n- **2025-12-22** â€” CI enforces **hard regression gates**: schema validity, Tier 0 FN=0, Tier 2/Tier 3 violations=0.  \n  **Status:** âœ… Decided  \n  - Rationale: Prevents unsafe automation and missed escalations from reaching production.  \n  - Document: `docs/08_Testing_Quality/LLM_Regression_Gates_Checklist.md`\n\n- **2025-12-22** â€” Golden set labeling is governed by a formal SOP (dual labeling + adjudication + versioning).  \n  **Status:** âœ… Decided  \n  - Rationale: Ensures eval credibility and supports long-term drift control.  \n  - Document: `docs/04_LLM_Design_Evaluation/Golden_Set_Labeling_SOP.md`\n\n- **2025-12-22** â€” Wave 05 templates use **Mustache-style placeholders** (no logic, optional sections supported).  \n  **Status:** âœ… Decided  \n  - Rationale: Deterministic rendering, easy review, and safe missing-variable behavior.  \n  - Document: `docs/05_FAQ_Automation/Template_Rendering_and_Variables.md`\n\n- **2025-12-22** â€” Middleware template files are the **source of truth**; Richpanel macros are treated as a synced mirror.  \n  **Status:** âœ… Decided  \n  - Rationale: Prevents copy drift; enables versioning, review, and regression testing.  \n  - Document: `docs/05_FAQ_Automation/Macro_Alignment_and_Governance.md`\n\n- **2025-12-22** â€” v1 automated replies **must not include shipping/billing addresses**, even if available.  \n  **Status:** âœ… Decided  \n  - Rationale: Reduces privacy risk and â€œwrong orderâ€ harm; aligns with fail-closed posture.  \n  - Document: `docs/05_FAQ_Automation/Order_Status_Automation.md`\n\n- **2025-12-22** â€” Tier 0 acknowledgements (chargeback/legal/fraud/harassment) are **disabled by default** (route-only in early rollout).  \n  **Status:** âœ… Decided  \n  - Rationale: Avoids unintended legal/financial commitments; keeps escalation workflows clean.  \n  - Document: `docs/05_FAQ_Automation/Templates_Library_v1.md`\n\n\n- **2025-12-22** â€” Standardize template placeholders on **Mustache** syntax (`{{var}}` and sections).  \n  **Status:** âœ… Decided  \n  - Rationale: Templates are machine-rendered; a single placeholder format prevents copy/engine drift.\n  - Owner: PM\n\n- **2025-12-22** â€” Introduce `brand_constants_v1.yaml` to centralize brand name, signature, and policy links for templates.  \n  **Status:** âœ… Decided  \n  - Rationale: Avoids editing 20+ templates when a signature or link changes; reduces drift.\n  - Owner: PM + Support Ops\n\n- **2025-12-22** â€” Create a dedicated Richpanel macro set prefixed `AUTO:` for automation-aligned replies (optional but recommended).  \n  **Status:** ğŸŸ¡ Proposed  \n  - Rationale: Improves agent consistency and reduces copy drift. Middleware does not depend on Richpanel macros.\n  - Owner: Support Ops\n\n- **2025-12-22** â€” Sender identity for automated replies should appear as â€œSupportâ€ (not â€œBotâ€), with a stable signature.  \n  **Status:** ğŸŸ¡ Proposed (recommended default)  \n  - Rationale: Reduces customer confusion and aligns with existing macro tone; keeps transparency without derailing threads.\n  - Owner: Support Ops\n\n- **2025-12-22** â€” Channel scope for auto-send (v1): enable on LiveChat + Email; route-only on Social/TikTok/Phone until validated.  \n  **Status:** ğŸŸ¡ Proposed (recommended default)  \n  - Rationale: Highest ROI channels with lowest public-facing risk; staged rollout reduces incidents.\n  - Owner: Support Ops + PM\n\n\n- **2025-12-22** â€” Wave 05 defaults: enable FAQ auto-replies on **LiveChat + Email**; keep **Social/TikTok/Phone** route-only in v1.  \n  **Status:** âœ… Decided (default; can be overridden)  \n  - Rationale: maximizes ROI while limiting higher-risk/public channels until validated.\n  - Owner: PM + Support Ops\n\n- **2025-12-22** â€” Wave 05 defaults: automated replies appear as **Support** (not â€œBotâ€), with email signature `â€” {{support_signature}}`.  \n  **Status:** âœ… Decided (default; can be overridden)  \n  - Rationale: reduces customer friction and keeps tone consistent.\n  - Owner: PM + Support Ops\n\n- **2025-12-22** â€” Wave 05 defaults: do **not** prepend â€œAutomated update:â€ in v1.  \n  **Status:** âœ… Decided (default; can be overridden)  \n  - Rationale: avoids drawing attention to automation; templates already include a human handoff.\n  - Owner: PM\n\n- **2025-12-22** â€” Wave 05 defaults: policy/help links are **disabled by default** (URLs remain blank) until verified.  \n  **Status:** âœ… Decided (default; can be overridden)  \n  - Rationale: prevents shipping incorrect links; links can be enabled safely via `brand_constants_v1.yaml`.\n  - Owner: PM + Support Ops\n\n- **2025-12-22** â€” Wave 05 baseline: `support_signature` default is **Customer Support** until brand constants are populated.  \n  **Status:** âœ… Decided (implementation-safe default)  \n  - Rationale: prevents placeholder leakage while allowing implementation to proceed.\n  - Owner: PM\n\n\n- **2025-12-22** â€” Wave 06 â€” Adopt a strict **PII minimization + redaction** policy:\n  - no raw message bodies stored by default\n  - redact PII before logging\n  - do not log OpenAI request/response bodies (metadata only)\n  - Tier 2 disclosure only with deterministic match  \n  **Status:** âœ… Decided  \n  - Rationale: PII leakage and wrong-customer disclosure are the highest-risk failure modes.\n  - Owner: PM + Engineering\n\n- **2025-12-22** â€” Wave 06 â€” Store all credentials in **AWS Secrets Manager** and rotate quarterly (or immediately on suspicion of exposure).  \n  **Status:** âœ… Decided  \n  - Rationale: avoids secret sprawl and supports clean environment separation.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 06 â€” Webhook authentication strategy is **tiered**:\n  - preferred: HMAC signature + timestamp (anti-replay)\n  - fallback: header token\n  - last resort: URL token  \n  **Status:** ğŸŸ¡ Proposed (verify Richpanel HTTP Target capabilities)  \n  - Rationale: supports production security even if Richpanel tenant capabilities are limited.\n  - Owner: Engineering + Support Ops\n\n\n\n---\n\n## 2025-12-22 â€” Wave 06 (Update 2)\n\n- **2025-12-22** â€” Wave 06 â€” Add an operational **kill switch / safe mode**:\n  - global `automation_enabled` flag (route-only when off)\n  - `safe_mode` flag (forces route-only; reduces concurrency)\n  - template-level enable flags  \n  **Status:** âœ… Decided  \n  - Rationale: the highest-risk failure mode is incorrect or abusive automation; we must be able to stop it quickly without code changes.\n  - Default storage: SSM Parameter Store (runtime flags) with short cache TTL.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 06 â€” Adopt an AWS **security baseline checklist** for v1 production readiness.  \n  **Status:** âœ… Decided  \n  - Rationale: avoids â€œtribal knowledgeâ€ security setup and prevents common misconfigurations (no MFA, no DLQ alarms, no budgets, etc.).\n  - Includes: API throttling, webhook auth, DLQ+alarms, log retention, secrets manager, least privilege roles.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 06 â€” Prod ingress protection includes:\n  - API Gateway throttling (required)\n  - AWS WAF rate-based rule (recommended)  \n  **Status:** ğŸŸ¡ Proposed (depends on cost/ops preference)  \n  - Rationale: WAF reduces abuse risk; we can defer if throttling + strong auth is sufficient for v1.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Establish a **minimum security monitoring baseline** (alarms + dashboards) for v1.  \n  **Status:** âœ… Decided  \n  - Rationale: Prevent silent failures, detect abuse/PII risk quickly, and reduce time-to-containment.  \n  - Owner: Engineering\n\n- **2025-12-22** â€” Webhook secrets rotate with **overlap** (accept multiple active tokens; no-downtime rotation).  \n  **Status:** âœ… Decided  \n  - Rationale: Prevent inbound disruptions during routine rotation and enable emergency rotation during compromise.  \n  - Owner: Engineering\n\n- **2025-12-22** â€” Use a controlled **break-glass role** + monthly IAM access review cadence for prod.  \n  **Status:** âœ… Decided  \n  - Rationale: Enables fast incident response while limiting routine access and maintaining auditability.  \n  - Owner: Engineering + Leadership\n\n---\n\n## 2025-12-22 â€” Wave 07 (Update 1)\n\n- **2025-12-22** â€” Wave 07 â€” Reliability posture uses **queue buffering + bounded concurrency** as the primary scaling control.  \n  **Status:** âœ… Decided  \n  - Default: Worker Lambda reserved concurrency starts at **10** and is tuned based on queue age and 429 rates.\n  - Rationale: our traffic is modest; downstream rate limits are the true bottleneck; bounded concurrency prevents stampedes.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 07 â€” Queue strategy remains **SQS FIFO** with `MessageGroupId = conversation_id`.  \n  **Status:** âœ… Decided  \n  - Rationale: preserves per-conversation ordering, reduces tag thrash, and simplifies idempotency at low-to-moderate throughput.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 07 â€” DR posture for v1 is **single region (us-east-2), multi-AZ**, with operational fallbacks (route-only / manual ops).  \n  **Status:** âœ… Decided  \n  - Rationale: multi-region adds complexity; v1 priority is safe routing/automation with kill switches; agents can always respond manually.\n  - Owner: Engineering + Leadership\n\n\n---\n\n## 2025-12-22 â€” Wave 07 (Update 2 / Closeout)\n\n- **2025-12-22** â€” Wave 07 â€” Canonical v1 runtime config is maintained in:\n  - `docs/07_Reliability_Scaling/parameter_defaults_v1.yaml`\n  - with a human summary in `Parameter_Defaults_Appendix.md`\n  **Status:** âœ… Decided  \n  - Rationale: avoids config drift and makes tuning/review explicit.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 07 â€” Degraded mode strategy uses:\n  - `safe_mode=true` as the default â€œroute-onlyâ€ recovery mode\n  - `automation_enabled=false` as the hard automation stop\n  **Status:** âœ… Decided  \n  - Rationale: fastest, safest recovery lever without code deploys.\n  - Owner: Engineering + Support Ops\n\n- **2025-12-22** â€” Wave 07 â€” Backlog catch-up and DLQ replay are **operator-controlled** and throttled:\n  - no unbounded drain\n  - replay only after root cause fixed\n  - always idempotent\n  **Status:** âœ… Decided  \n  - Rationale: prevents rate-limit storms, duplicate replies, and cost spikes.\n  - Owner: Engineering + Support Ops\n\n\n---\n\n## 2025-12-22 â€” Wave 08 (Update 1)\n\n- **2025-12-22** â€” Wave 08 â€” Observability uses **structured JSON event logs** with a canonical taxonomy (`observability_event_taxonomy_v1.yaml`).  \n  **Status:** âœ… Decided  \n  - Rationale: enables timeline reconstruction per ticket, consistent dashboards, and safer analytics exports.\n  - Security: no raw message bodies in prod logs by default.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 08 â€” Metrics follow a **low-cardinality catalog** and map directly to SLOs + alarms.  \n  **Status:** âœ… Decided  \n  - Rationale: keeps CloudWatch costs predictable and avoids dimensional explosions; detailed breakdowns use logs/export.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 08 â€” v1 analytics approach is **CloudWatch-first**, with optional export of sanitized events to **S3/Athena** for weekly/monthly trends.  \n  **Status:** âœ… Decided  \n  - Rationale: minimizes ops for v1 while preserving a growth path for deeper analytics and drift monitoring.\n  - Owner: Engineering + Support Ops\n\n- **2025-12-22** â€” Wave 08 â€” All stages emit and propagate a single correlation identifier: `mw_trace_id`.  \n  **Status:** âœ… Decided  \n  - Rationale: investigation speed; unify ingress â†’ queue â†’ worker â†’ vendor calls.\n  - Owner: Engineering\n\n- **2025-12-22** â€” Wave 08 â€” Early rollout includes **explicit agent feedback signals** via tags/macros (misroute, auto-reply wrong/helpful).  \n  **Status:** ğŸŸ¡ Proposed (requires Support Ops adoption)  \n  - Rationale: best signal for improving routing and automation safely; reduces labeling cost.\n  - Owner: Support Ops + Engineering\n\n- **2025-12-22** â€” Wave 08 â€” EvalOps cadence:\n  - daily QA sampling\n  - weekly golden set regression runs\n  - monthly calibration reviews  \n  **Status:** âœ… Decided  \n  - Rationale: routing quality is an operational metric; drift is expected and must be managed continuously.\n  - Owner: Engineering + Support Ops\n\n- **2025-12-22** â€” Wave 08 â€” Analytics export posture (sanitized events):\n  - CloudWatch-first is **required** for day-to-day operations\n  - sanitized S3 export (CloudWatch Logs â†’ Firehose â†’ S3) is **optional**\n  - Best-suggested rollout: enable in **staging** early; enable in **prod** after the first rollout window if comfortable  \n  **Status:** âœ… Decided  \n  - Rationale: do not block go-live on analytics plumbing; enable cheap long-term trending when ready.\n  - Owner: Engineering + Support Ops\n\n\n\n---\n\n## 2025-12-22 â€” Wave 09 (Update 1)\n\n- **2025-12-22** â€” Treat **prompt/template/schema changes as release-sensitive artifacts** and gate them with:\n  - schema validation\n  - golden set eval + regression gates\n  - explicit approval before production promotion  \n  **Status:** âœ… Decided  \n  - Rationale: model behavior can change materially without code changes; we must prevent silent regressions.\n  - Owner: Engineering + Support Ops\n\n- **2025-12-22** â€” Production release strategy will be **progressive enablement**:\n  1) deploy with `safe_mode=true` + `automation_enabled=false` (routing only)\n  2) enable Tier 1 automation for a small template whitelist\n  3) enable Tier 2 verified automation only after deterministic match is validated in prod  \n  **Status:** âœ… Decided  \n  - Rationale: reduces blast radius and aligns to kill-switch posture.\n  - Owner: Engineering\n\n---\n\n## 2025-12-22 â€” Wave 09 (Update 2 closeout)\n\n- **2025-12-22** â€” Adopt a **smoke test pack** as the minimum pre-release evidence set:\n  - routing baseline subset required for any deploy\n  - Tier 1 subset required if enabling automation\n  - Tier 2 subset required only if deterministic match + Tier 2 templates are enabled  \n  **Status:** âœ… Decided  \n  - Rationale: fast, repeatable, high-signal coverage reduces release risk and prevents â€œwe forgot to test itâ€ incidents.\n  - Owner: Engineering + Support Ops\n\n- **2025-12-22** â€” First production deploy must follow a written, step-by-step runbook and use config-first rollback:\n  - `automation_enabled=false`\n  - `safe_mode=true`\n  - template-level disablement before code rollback  \n  **Status:** âœ… Decided  \n  - Rationale: fastest rollback is configuration, not redeploy; avoids downtime and reduces blast radius.\n  - Owner: Engineering\n\n## Wave 10 â€” Operations and runbooks\n\n- **Date:** 2025-12-22  \n  **Decision:** Adopt the v1 operational posture: **fail-closed**, emergency levers (`safe_mode`, `automation_enabled`), and severity levels (SEV-0â€“SEV-3) as defined in the Wave 10 operations handbook.  \n  **Status:** âœ… Decided  \n  - Rationale: Enables fast, consistent incident response without requiring ad-hoc decisions during customer-impacting events.\n\n- **Date:** 2025-12-22  \n  **Decision:** Maintain an initial â€œsingle-owner on-callâ€ model (engineering primary + documented escalation), with Support Ops escalation for customer-facing guidance and template governance.  \n  **Status:** âœ… Decided  \n  - Rationale: Matches early team size while preventing â€œownership ambiguityâ€ during incidents.\n\n## Wave 11 â€” Governance and continuous improvement\n\n\n- **Date:** 2025-12-22  \n  **Decision:** Adopt the v1 governance cadence: daily ops check, weekly quality triage, bi-weekly change review, monthly calibration run, quarterly governance review.  \n  **Status:** âœ… Decided  \n  - Rationale: Establishes a predictable improvement loop without heavy process overhead.\n\n- **Date:** 2025-12-22  \n  **Decision:** Treat prompts, templates, schemas, and thresholds as versioned release artifacts; no direct production edits without a repo change and logged decision.  \n  **Status:** âœ… Decided  \n  - Rationale: Prevents untracked drift and makes behavior reversible.\n\n- **Date:** 2025-12-22  \n  **Decision:** Use the â€œsmallest safe fixâ€ rule: prefer disabling templates, tightening gates, or adjusting thresholds before prompt/taxonomy refactors.  \n  **Status:** âœ… Decided  \n  - Rationale: Reduces blast radius and accelerates safe iteration.\n\n\n\n- **Date:** 2025-12-22  \n  **Decision:** Adopt a lightweight governance operating system: Governance Quick Start + monthly audit checklist to prevent drift in prompts/templates/schemas/mappings.  \n  **Status:** âœ… Decided  \n  - Rationale: Ensures repeatable safe changes and early detection of drift without heavy process overhead.\n\n- **2025-12-23** â€” Wave 12 execution packs created (WBS + dependency map + 49 build tickets + Cursor run prompts).  \n  **Status:** âœ… Decided\n\n- **2025-12-23** â€” Wave 12 sprint plan + v1 cutline finalized (planning aids only; adjust to team capacity).  \n  **Decision:** Use Sprint 0â€“5 sequence for implementation; classify tickets as P0/P1/P2 and V1 vs POST_V1.  \n  **Why:** Balances delivery speed with safety gates (route-only first, then limited automation).  \n  **Status:** âœ… Decided\n- **2025-12-23** â€” Jira import approach: two-pass (create epics first, then tasks after epic keys exist).\n  **Decision:** Provide `jira_epics_import_v1.csv` and `jira_stories_import_v1.csv` with placeholders for Epic Link.\n  **Why:** Jira CSV import needs Epic keys; prevents broken links.\n  **Status:** âœ… Decided\n\n---\n\n## 2025-12-29 â€” GitHub Merge + Auto-merge Policy\n\n- **2025-12-29** â€” PR merge strategy: **merge commits only** (squash and rebase disabled).\n  **Status:** âœ… Decided\n  - Rationale: Merge commits preserve per-RUN audit trail for Cursor agent work.\n  - Owner: Engineering\n\n- **2025-12-29** â€” Auto-delete head branches after merge: **enabled**.\n  **Status:** âœ… Decided\n  - Rationale: Prevents branch explosion (50+ stale run branches).\n  - Owner: Engineering\n\n- **2025-12-29** â€” Branch protection for `main`: require PR, require `CI/validate` green, require conversations resolved.\n  **Status:** âœ… Decided\n  - Rationale: Prevents bypassing CI and ensures all agents follow the same safety gates.\n  - Owner: Engineering\n\n---\n\n## 2025-12-30 â€” Dev/Staging Deploy Workflows\n\n- **2025-12-30** â€” Add GitHub Actions workflows for dev and staging CDK deploys via OIDC.\n  **Status:** âœ… Decided\n  - Rationale: Enables repeatable, auditable deploys without storing long-lived AWS credentials.\n  - Owner: Engineering\n\n---\n\n## 2026-01-02 â€” E2E Smoke Workflows\n\n- **2026-01-02** â€” Add Dev E2E smoke test workflow (`dev-e2e-smoke.yml`) and script (`dev_e2e_smoke.py`).\n  **Status:** âœ… Decided\n  - Rationale: Validates end-to-end flow (webhook â†’ queue â†’ worker â†’ DynamoDB) before promoting to staging.\n  - Owner: Engineering\n\n- **2026-01-02** â€” Add Staging E2E smoke test workflow (`staging-e2e-smoke.yml`).\n  **Status:** âœ… Decided\n  - Rationale: Validates staging environment before promoting to prod.\n  - Owner: Engineering\n\n---\n\n## 2026-01-03 â€” Docs Heartbeat + Anti-drift Enforcement\n\n- **2026-01-03** â€” Add CI gate (`scripts/verify_admin_logs_sync.py`) to enforce that latest RUN_ID is referenced in Progress_Log.md.\n  **Status:** âœ… Decided\n  - Rationale: Prevents "docs look stale" problem permanently by making progress logs auditable and enforced in CI.\n  - Owner: Engineering
\n\n- **2026-01-03** â€” Smoke tests must verify all persistence tables (idempotency, conversation_state, audit_trail) and audit items require sort key `ts_action_id=<recorded_at>#<event_id>`.\n  **Status:** âœ… Decided\n  - Rationale: Prevents silent drift between CDK table definitions and worker writes; ensures evidence links prove durable storage without exposing secrets.\n  - Owner: Engineering\n\n- **2026-01-03** â€” Prod promotion requires an explicit human go/no-go plus captured workflow evidence: `deploy-prod` run URL and `prod-e2e-smoke` run URL must be recorded before enabling prod traffic.\n  **Status:** âœ… Decided\n  - Rationale: Prevents accidental prod deploys and preserves auditability of production changes.\n  - Owner: Engineering + PM/Lead approver\n\n- **2026-01-03** â€” Dev/Staging E2E smoke evidence must include observed idempotency + conversation_state + audit records and list CloudWatch dashboard/alarm names when surfaced in outputs.\n  **Status:** âœ… Decided\n  - Rationale: Tightens the evidence loop so reviewers can see persistence + monitoring coverage without digging through logs.\n  - Owner: Engineering