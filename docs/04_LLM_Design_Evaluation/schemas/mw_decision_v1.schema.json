{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "mw_decision_v1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "language",
    "primary_intent",
    "secondary_intents",
    "routing",
    "automation",
    "risk",
    "clarifying_questions",
    "notes_for_agent"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "enum": [
        "mw_decision_v1"
      ]
    },
    "language": {
      "type": "string",
      "enum": [
        "en",
        "es",
        "unknown"
      ]
    },
    "primary_intent": {
      "type": "string",
      "enum": [
        "order_status_tracking",
        "shipping_delay_not_shipped",
        "delivered_not_received",
        "missing_items_in_shipment",
        "wrong_item_received",
        "damaged_item",
        "cancel_order",
        "address_change_order_edit",
        "cancel_subscription",
        "billing_issue",
        "promo_discount_issue",
        "pre_purchase_question",
        "influencer_marketing_inquiry",
        "return_request",
        "exchange_request",
        "refund_request",
        "technical_support",
        "phone_support_request",
        "tiktok_support_request",
        "social_media_support_request",
        "chargeback_dispute",
        "legal_threat",
        "harassment_threats",
        "fraud_suspected",
        "unknown_other"
      ]
    },
    "secondary_intents": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "order_status_tracking",
          "shipping_delay_not_shipped",
          "delivered_not_received",
          "missing_items_in_shipment",
          "wrong_item_received",
          "damaged_item",
          "cancel_order",
          "address_change_order_edit",
          "cancel_subscription",
          "billing_issue",
          "promo_discount_issue",
          "pre_purchase_question",
          "influencer_marketing_inquiry",
          "return_request",
          "exchange_request",
          "refund_request",
          "technical_support",
          "phone_support_request",
          "tiktok_support_request",
          "social_media_support_request",
          "chargeback_dispute",
          "legal_threat",
          "harassment_threats",
          "fraud_suspected",
          "unknown_other"
        ]
      },
      "maxItems": 2
    },
    "routing": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "destination_team",
        "confidence",
        "needs_manual_triage",
        "tags"
      ],
      "properties": {
        "destination_team": {
          "type": "string",
          "enum": [
            "Sales Team",
            "Backend Team",
            "Technical Support Team",
            "Phone Support Team",
            "TikTok Support",
            "Returns Admin",
            "LiveChat Support",
            "Leadership Team",
            "SocialMedia Team",
            "Email Support Team",
            "Chargebacks / Disputes Team"
          ]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "needs_manual_triage": {
          "type": "boolean"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "maxItems": 12
        }
      }
    },
    "automation": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "tier",
        "action",
        "template_id",
        "confidence",
        "requires_deterministic_match"
      ],
      "properties": {
        "tier": {
          "type": "string",
          "enum": [
            "TIER_0_ESCALATION",
            "TIER_1_SAFE_ASSIST",
            "TIER_2_VERIFIED",
            "TIER_3_AUTO_ACTION"
          ]
        },
        "action": {
          "type": "string",
          "enum": [
            "ROUTE_ONLY",
            "SEND_TEMPLATE",
            "ACK_ONLY"
          ]
        },
        "template_id": {
          "type": [
            "string",
            "null"
          ],
          "enum": [
            "t_order_status_ask_order_number",
            "t_order_status_verified",
            "t_shipping_delay_verified",
            "t_delivered_not_received_intake",
            "t_missing_items_intake",
            "t_wrong_item_intake",
            "t_damaged_item_intake",
            "t_cancel_order_ack_intake",
            "t_address_change_ack_intake",
            "t_cancel_subscription_ack_intake",
            "t_billing_issue_intake",
            "t_return_request_intake",
            "t_exchange_request_intake",
            "t_refund_request_intake",
            "t_technical_support_intake",
            "t_promo_discount_info",
            "t_pre_purchase_info",
            "t_influencer_inquiry_route",
            "t_chargeback_neutral_ack",
            "t_legal_threat_ack",
            "t_harassment_ack",
            "t_fraud_ack",
            "t_unknown_ack",
            null
          ]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "requires_deterministic_match": {
          "type": "boolean"
        }
      }
    },
    "risk": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "flags",
        "force_human"
      ],
      "properties": {
        "flags": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "CHARGEBACK_DISPUTE",
              "LEGAL_THREAT",
              "HARASSMENT_THREATS",
              "FRAUD_SUSPECTED",
              "OTHER_HIGH_RISK"
            ]
          },
          "maxItems": 3
        },
        "force_human": {
          "type": "boolean"
        }
      }
    },
    "clarifying_questions": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "ASK_ORDER_NUMBER",
          "ASK_EMAIL_OR_PHONE",
          "ASK_SHIPPING_ZIP",
          "ASK_PHOTO_OR_VIDEO",
          "ASK_PRODUCT_MODEL",
          "ASK_TROUBLESHOOTING_DETAILS"
        ]
      },
      "maxItems": 3
    },
    "notes_for_agent": {
      "type": "string",
      "maxLength": 500
    }
  }
}